\documentclass[xcolor={dvipsnames}]{beamer}
\usetheme{metropolis}
\author{Pepijn Kokke}
\title{Give or Take: Non-Determinism, Linear Logic and Session Types}
\institute{University of Edinburgh}
\input{preamble}

\begin{document}

\maketitle

\begin{frame}
 \frametitle{Example: dramatis person\ae}
 \centering\Huge
 \begin{tabular}{lll}
   \mary   && Mary           \\
   \john   && John           \\
   \store  && P\^{a}tisserie \\
   \cake   && Cake           \\
   \nocake && No Cake
 \end{tabular}
\end{frame}

\begin{frame}[label=frmex]
  \frametitle{Example: buying cake at the p\^{a}tisserie}
  \wide[4cm]{%
    \begin{center}
      \amb
      {\new{x}\paren{
          \quad \recv{x}{y}\john \quad \conc%
          \quad \recv{x}{z}\mary \quad \conc%
          \quad \send[u]{x}{\cake}\send[u]{x}{\nocake}\store \quad}}
      {\paren{\: \subst{\john}{\cake}{y} \:\conc\: \subst{\mary}{\nocake}{z} \:\conc\: \store \:}}
      {\paren{\: \subst{\john}{\nocake}{y} \:\conc\: \subst{\mary}{\cake}{z} \:\conc\: \store \:}}
    \end{center}
  }
\end{frame}

\begin{frame}
  \frametitle{The $\pi$-calculus: syntax}
  \[\!
    \begin{aligned}
      \text{Term}\;\PP,\QQ,\RR\\
      \quad  ::=&\;{\new{x}\PP         }&&\text{create a new channel $x$, then run P}
      \\    \mid&\;{\send[u]{x}{y}\PP  }&&\text{send a channel $y$ over $x$, then run P}
      \\    \mid&\;{\recv{x}{y}\PP     }&&\text{receive a channel $y$ over $x$, then run P}
      \\    \mid&\;{\paren{\PP\conc\QQ}}&&\text{run P and Q in parallel}
      \\    \mid&\;{\halt              }&&\text{halt}
    \end{aligned}
  \]
\end{frame}

\againframe{frmex}

\begin{frame}
  \frametitle{Pitfall: illegal resale of cake}
  \centering
  \vfill\Huge
  \begin{tabular}{lll}
    \money && Money \\
  \end{tabular}
  \vfill\Large
  \[
    \new{x}\paren{
      \quad
      \recv{x}{\money}\send[u]{x}{\cake}\john
      \quad\conc\quad
      \recv{x}{\cake}\send[u]{x}{\money}\mary
      \quad
    }
  \]
  \vfill
\end{frame}

\begin{frame}[label=frmty]
  \frametitle{Session types to the rescue}
  \centering
  \only<1,2,3>{
    \vfill
    {\Large
      \[
        \text{Type} \; \tm{A} , \tm{B} ::=
        \tm{\alpha} \mid \tm{\alpha^\bot} \mid \tm{A \tens B} \mid \tm{A \parr B}
        \mid \dots
      \]
    }  
  }
  \only<1>{
    \vfill
    \def\hinuf{\vphantom{{}^\bot}}
    \begin{tabular}{lll}
      \Large $\tm[x_1]{\cake^\bot}$      && channel from which you \textbf{get cake} \\
      \Large $\tm[x_2]{\cake\hinuf}$     && channel in which you \textbf{put cake} \\ 
      \Large $\tm[x_3]{\money^\bot}$     && channel from which you \textbf{get money} \\
      \Large $\tm[x_4]{\money\hinuf}$    && channel in which you \textbf{put money} \\
      \Large $\tm[x_5]{A \tens B\hinuf}$ && \textbf{independent} pair of channels \\
      \Large $\tm[x_6]{A \parr B\hinuf}$ && possibly \textbf{dependent} pair of channels
    \end{tabular}
    \vfill
  }
  \only<2,3>{
    {
      \Large
      \onslide<3>{\(
        \send{x}{y}\PP ::= \send[b]{x}{y}\PP
      \)}
      \vfill
      \begin{proofblock}[1]
        \AXC{$\seq[ P ]{ \Gamma , \tm[y]{A} }$}
        \AXC{$\seq[ Q ]{ \Delta , \tm[x]{B} }$}
        \SYM{\tens}
        \BIC{$\seq[{ \only<2>{\send[b]{x}{y}}\only<3>{\send{x}{y}}(P \conc Q) }]{ \Gamma , \Delta , \tm[x]{A \tens B}}$}
      \end{proofblock}
      \begin{proofblock}[1]
        \AXC{$\seq[ P ]{ \Gamma , \tm[y]{A} , \tm[x]{B}}$}
        \SYM{\parr}
        \UIC{$\seq[ \recv{x}{y}P ]{ \Gamma , \tm[x]{A \parr B}}$}
      \end{proofblock}
    }
    \vfill
  }
  \only<4>{
    {
      \vfill\Large
      \begin{proofblock}[1]
        \AXC{$\seq[ P ]{ \Gamma , \tm[x]{A} }$}
        \AXC{$\seq[ Q ]{ \Delta , \tm[x]{A^\bot} }$}
        \NOM{Cut}
        \BIC{$\seq[ \new{x}(P \conc Q) ]{ \Gamma , \Delta }$}
      \end{proofblock}
      \vfill
    }
  }
  \only<5>{
    \vfill\Large
    \[\!
      \arraycolsep=0.25em%
      \def\arraystretch{1.5}%
      \begin{array}{ccc}
        & \text{Type of $\color{tm}x$ used by \john}
        & \text{Type of $\color{tm}x$ used by \mary}
        \\ \cline{2-3}
        \good & \tm{\money^\bot \parr \cake} & \tm{\money \tens \cake^\bot} \\ 
        \good & \tm{\money^\bot \tens \cake} & \tm{\money \parr \cake^\bot} \\ \cline{2-3}
        \bad  & \tm{\money^\bot \parr \cake} & \tm{\money \parr \cake^\bot} \\
        \bad  & \tm{\money^\bot \tens \cake} & \tm{\money \tens \cake^\bot}
      \end{array}
    \]
  }
  \only<6>{
    {
      \Large
      \[
        \new{x}\paren{
          \quad\recv{x}{y}\john\quad\conc\quad\send{x}{w}
          \paren{\;\link{w}{\money}\;\conc\;\recv{x}{z}\mary\;}\quad}
      \]
    }
  }
\end{frame}

\againframe{frmex}

\begin{frame}
  \frametitle{Non-Deterministic Classical Processes}
  \vspace*{1\baselineskip}
  \vfill
  \only<1>{
    \Large
    \begin{proofblock}[1]
      \AXC{$\seq[ P ]{ \Gamma , \tm[x]{A} }$}
      \AXC{$\seq[ Q ]{ \Delta , \tm[x]{A^\bot} }$}
      \NOM{Cut}
      \BIC{$\seq[ \new{x}(P \conc Q) ]{ \Gamma , \Delta }$}
    \end{proofblock}
  }
  \only<2-4>{
    \wide{
      \centering
      \amb{%
        \def\pSeq{\ensuremath{%
            \seq[ P ]{ \Gamma , \tm[y]{A} }}}
        \def\qSeq{\ensuremath{%
            \seq[ Q ]{ \Delta , \tm[z]{A} }}}
        \def\rSeq{\ensuremath{%
            \seq[ R ]{ \Theta , \tm[u]{A^\bot}, \tm[v]{A^\bot} }}}
        \def\lhsTm{\ensuremath{%
            \paren{\; \recv{x}{y}P \;\conc\; \recv{x}{z}Q \;}}}
        \def\rhsTm{\ensuremath{%
            \send{x}{u}\send{x}{v}{R}}}
        \def\finTm{\ensuremath{%
            \new{x}\paren{\; \lhsTm \;\conc\; \rhsTm \;}}}
        \def\finSeq{\ensuremath{%
            \seq[ \finTm ]{ \Gamma , \Delta, \Theta }}}
        \only<2>{%
          \begin{proofbox}[1]
            \AXC{\pSeq}
            \AXC{\qSeq}
            \AXC{\rSeq}
            \noLine\TIC{$\vdots$}\noLine
            \UIC{\finSeq}
          \end{proofbox}
        }
        \only<3,4>{%
          \begin{proofbox}[1]
            \AXC{\pSeq}
            \AXC{\qSeq}
            \noLine\BIC{$\vdots$}\noLine
            \UIC{$\seq[\lhsTm]{\Gamma, \Delta,
                \tm[x]{\only<3>{???}\only<4>{\take[2]{A}} }}$}
            \AXC{\rSeq}
            \noLine\UIC{$\vdots$}\noLine
            \UIC{$\seq[\rhsTm]{\Theta,
                \tm[x]{\only<3>{???}\only<4>{\give[2]{A^\bot}}} }$}
            \NOM{Cut}
            \BIC{\finSeq}
          \end{proofbox}
        }
      }%
      {\paren{\; \subst{P}{u}{y} \;\conc\; \subst{Q}{v}{z} \;\conc\; \RR \;}}%
      {\paren{\; \subst{P}{v}{y} \;\conc\; \subst{Q}{u}{z} \;\conc\; \RR \;}}%
    }
  }
  \vfill
\end{frame}

\begin{frame}[label=nodcap]
  \frametitle{Non-Deterministic Classical Processes}
  \[
    \text{Type} \; \tm{A}, \tm{B} ::= \dots \mid \tm{\give[n]{A}} \mid \tm{\take[n]{A}}
  \]
  \[\!
    \begin{aligned}
      \text{Term} \; {\color{tm}P}, {\color{tm}Q}, {\color{tm}R} ::= \dots
      \mid {\color{tm}{\send{x}{y}P}}
      \mid {\color{tm}{\recv{x}{y}P}}
    \end{aligned}
  \]

  \begin{center}
    \begin{proofbox}[1]
      \AXC{$\seq[{P}]{ \Gamma , \tm[y]{A} }$}
      \SYM{\give[1]{}}
      \UIC{$\seq[{{\send{x}{y}P}}]{ \Gamma , \tm[x]{\give[1]{A}} }$}
    \end{proofbox}
    \begin{proofbox}[1]
      \AXC{$\seq[P]{ \Gamma , \tm[y]{A} }$}
      \SYM{\take[1]{}}
      \UIC{$\seq[{{\recv{x}{y}P}}]{ \Gamma , \tm[x]{\take[1]{A}} }$}
    \end{proofbox}
  \end{center}

  \begin{proofblock}[1]
    \AXC{$\seq[{ P }]{ \Gamma , \tm[x]{\give[m]{A}} , \tm[y]{\give[n]{A}} }$}
    \NOM{Contract}
    \UIC{$\seq[{ \subst{P}{x}{y} }]{ \Gamma , \tm[x]{\give[m+n]{A}} }$}
  \end{proofblock}
  \begin{proofblock}[1]
    \AXC{$\seq[{ P }]{ \Gamma , \tm[x]{\take[m]{A}} }$}
    \AXC{$\seq[{ Q }]{ \Delta , \tm[x]{\take[n]{A}} }$}
    \NOM{Pool}
    \BIC{$\seq[{ (P \mid Q) }]{ \Gamma , \Delta , \tm[x]{\take[m+n]{A}} }$}
  \end{proofblock}
\end{frame}


\end{document}

%%% Local Variables:
%%% TeX-master: "main"
%%% End:
